// Инициализирует таблицы значений, содержащие данные документа.
// Таблицы значений сохраняет в свойствах структуры "ДополнительныеСвойства".
//
Процедура ИнициализироватьДанныеДокумента(ДокументСсылка, ДополнительныеСвойства) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ДатаСреза", ДокументСсылка.Дата - 24 * 60 * 60);
	Запрос.УстановитьПараметр("Ссылка", ДокументСсылка);
	Запрос.УстановитьПараметр("Подразделение", ДокументСсылка.Подразделение);
	Запрос.Текст ="ВЫБРАТЬ
	              |	Сотрудники.Период,
	              |	Сотрудники.Пользователь,
	              |	Сотрудники.Подразделение,
	              |	Сотрудники.Ссылка.Подразделение КАК ПодразделениеДо,
	              |	Сотрудники.Должность,
	              |	Сотрудники.ГрафикРаботы,
	              |	Сотрудники.Оклад,
	              |	Сотрудники.Ранг,
	              |	ГруппыПользователей1.Ссылка КАК ГруппаПользователейИз,
	              |	ГруппыПользователей.Ссылка КАК ГруппаПользователейВ
	              |ИЗ
	              |	Документ.мИзменениеСведенийОСотрудниках.Сотрудники КАК Сотрудники
	              |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыПользователей КАК ГруппыПользователей
	              |		ПО (Сотрудники.Подразделение.Наименование ПОДОБНО ГруппыПользователей.Наименование)
	              |		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыПользователей КАК ГруппыПользователей1
	              |		ПО (Сотрудники.Ссылка.Подразделение.Наименование ПОДОБНО ГруппыПользователей1.Наименование)
	              |ГДЕ
	              |	Сотрудники.Ссылка = &Ссылка";
				  //|;
				  //|
				  //|////////////////////////////////////////////////////////////////////////////////
				  //|ВЫБРАТЬ
				  //| мИзменениеСведенийОСотрудникахСотрудники.Период,
				  //| мИзменениеСведенийОСотрудникахСотрудники.Пользователь,
				  //| мИзменениеСведенийОСотрудникахСотрудники.Оклад,
				  //| мИзменениеСведенийОСотрудникахСотрудники.Подразделение,
				  //| мИзменениеСведенийОСотрудникахСотрудники.Должность
				  //|ИЗ
				  //| Документ.мИзменениеСведенийОСотрудниках.Сотрудники КАК мИзменениеСведенийОСотрудникахСотрудники
				  //|ГДЕ
				  //| мИзменениеСведенийОСотрудникахСотрудники.Ссылка = &Ссылка
				  //|;
				  //|
				  //|////////////////////////////////////////////////////////////////////////////////
				  //|ВЫБРАТЬ
				  //| мИзменениеСведенийОСотрудникахСотрудники.Подразделение,
				  //| мИзменениеСведенийОСотрудникахСотрудники.Пользователь,
				  //| ГруппыПользователей.Ссылка
				  //|ПОМЕСТИТЬ Подразделения
				  //|ИЗ
				  //| Документ.мИзменениеСведенийОСотрудниках.Сотрудники КАК мИзменениеСведенийОСотрудникахСотрудники
				  //|     ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыПользователей КАК ГруппыПользователей
				  //|     ПО (мИзменениеСведенийОСотрудникахСотрудники.Подразделение.Наименование ПОДОБНО ГруппыПользователей.Наименование)
				  //|ГДЕ
				  //| мИзменениеСведенийОСотрудникахСотрудники.Ссылка = &Ссылка
				  //|;
				  //|
				  //|////////////////////////////////////////////////////////////////////////////////
				  //|ВЫБРАТЬ
				  //| мИзменениеСведенийОСотрудникахСотрудники.Пользователь
				  //|ПОМЕСТИТЬ Пользователи
				  //|ИЗ
				  //| Документ.мИзменениеСведенийОСотрудниках.Сотрудники КАК мИзменениеСведенийОСотрудникахСотрудники
				  //|ГДЕ
				  //| мИзменениеСведенийОСотрудникахСотрудники.Ссылка = &Ссылка
				  //|;
				  //|
				  //|////////////////////////////////////////////////////////////////////////////////
				  //|ВЫБРАТЬ
				  //| мСведенияОСотрудникахСрезПоследних.Подразделение КАК ПодразделениеДо,
				  //| мСведенияОСотрудникахСрезПоследних.Должность,
				  //| Пользователи.Пользователь КАК Пользователь,
				  //| мСведенияОСотрудникахСрезПоследних.Пользователь КАК Пользователь1,
				  //| ГруппыПользователейСостав.Ссылка КАК ГруппаДо,
				  //| Подразделения.Подразделение КАК ПодразделениеПосле,
				  //| Подразделения.Ссылка КАК ГруппаПосле
				  //|ИЗ
				  //| Пользователи КАК Пользователи
				  //|     ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.мСведенияОСотрудниках.СрезПоследних(&ДатаСреза, ) КАК мСведенияОСотрудникахСрезПоследних
				  //|     ПО Пользователи.Пользователь = мСведенияОСотрудникахСрезПоследних.Пользователь
				  //|     ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыПользователей.Состав КАК ГруппыПользователейСостав
				  //|     ПО Пользователи.Пользователь = ГруппыПользователейСостав.Пользователь,
				  //| Подразделения КАК Подразделения
				  //|ГДЕ
				  //| мСведенияОСотрудникахСрезПоследних.Пользователь = Пользователи.Пользователь";
				  
	Результат = Запрос.Выполнить().Выгрузить();
	//Результат = Запрос.ВыполнитьПакет();
  
	ТаблицыДляДвижений = ДополнительныеСвойства.ТаблицыДляДвижений;
	ТаблицыДляДвижений.Вставить("Таблица", Результат);
	//ТаблицыДляДвижений.Вставить("ТаблицаСведенияОПользователях", Результат[0].Выгрузить());
	//ТаблицыДляДвижений.Вставить("ТаблицаСведенияОСотрудниках", Результат[1].Выгрузить());
	//ТаблицыДляДвижений.Вставить("ТаблицаСведенияОСотрудникахИзменения", Результат[4].Выгрузить());
		
КонецПроцедуры 

// Инициализирует таблицы значений, содержащие данные документа.
// Таблицы значений сохраняет в свойствах структуры "ДополнительныеСвойства".
//
Процедура ИнициализироватьДанныеДокумента1(ДокументСсылка, ДополнительныеСвойства) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.УстановитьПараметр("ДатаСреза", ДокументСсылка.Дата - 24 * 60 * 60);
	Запрос.УстановитьПараметр("Ссылка", ДокументСсылка);
	Запрос.Текст ="ВЫБРАТЬ
                  | мИзменениеСведенийОСотрудникахСотрудники.Пользователь,
                  | мИзменениеСведенийОСотрудникахСотрудники.Подразделение,
                  | мИзменениеСведенийОСотрудникахСотрудники.Должность,
                  | мИзменениеСведенийОСотрудникахСотрудники.ГрафикРаботы,
                  | мИзменениеСведенийОСотрудникахСотрудники.Ранг
                  |ИЗ
                  | Документ.мИзменениеСведенийОСотрудниках.Сотрудники КАК мИзменениеСведенийОСотрудникахСотрудники
                  |ГДЕ
                  | мИзменениеСведенийОСотрудникахСотрудники.Ссылка = &Ссылка
                  |;
                  |
                  |////////////////////////////////////////////////////////////////////////////////
                  |ВЫБРАТЬ
                  | мИзменениеСведенийОСотрудникахСотрудники.Период,
                  | мИзменениеСведенийОСотрудникахСотрудники.Пользователь,
                  | мИзменениеСведенийОСотрудникахСотрудники.Оклад,
                  | мИзменениеСведенийОСотрудникахСотрудники.Подразделение,
                  | мИзменениеСведенийОСотрудникахСотрудники.Должность
                  |ИЗ
                  | Документ.мИзменениеСведенийОСотрудниках.Сотрудники КАК мИзменениеСведенийОСотрудникахСотрудники
                  |ГДЕ
                  | мИзменениеСведенийОСотрудникахСотрудники.Ссылка = &Ссылка
                  |;
                  |
                  |////////////////////////////////////////////////////////////////////////////////
                  |ВЫБРАТЬ
                  | мИзменениеСведенийОСотрудникахСотрудники.Подразделение,
                  | мИзменениеСведенийОСотрудникахСотрудники.Пользователь,
                  | ГруппыПользователей.Ссылка
                  |ПОМЕСТИТЬ Подразделения
                  |ИЗ
                  | Документ.мИзменениеСведенийОСотрудниках.Сотрудники КАК мИзменениеСведенийОСотрудникахСотрудники
                  |     ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыПользователей КАК ГруппыПользователей
                  |     ПО (мИзменениеСведенийОСотрудникахСотрудники.Подразделение.Наименование ПОДОБНО ГруппыПользователей.Наименование)
                  |ГДЕ
                  | мИзменениеСведенийОСотрудникахСотрудники.Ссылка = &Ссылка
                  |;
                  |
                  |////////////////////////////////////////////////////////////////////////////////
                  |ВЫБРАТЬ
                  | мИзменениеСведенийОСотрудникахСотрудники.Пользователь
                  |ПОМЕСТИТЬ Пользователи
                  |ИЗ
                  | Документ.мИзменениеСведенийОСотрудниках.Сотрудники КАК мИзменениеСведенийОСотрудникахСотрудники
                  |ГДЕ
                  | мИзменениеСведенийОСотрудникахСотрудники.Ссылка = &Ссылка
                  |;
                  |
                  |////////////////////////////////////////////////////////////////////////////////
                  |ВЫБРАТЬ
                  | мСведенияОСотрудникахСрезПоследних.Подразделение КАК ПодразделениеДо,
                  | мСведенияОСотрудникахСрезПоследних.Должность,
                  | Пользователи.Пользователь КАК Пользователь,
                  | мСведенияОСотрудникахСрезПоследних.Пользователь КАК Пользователь1,
                  | ГруппыПользователейСостав.Ссылка КАК ГруппаДо,
                  | Подразделения.Подразделение КАК ПодразделениеПосле,
                  | Подразделения.Ссылка КАК ГруппаПосле
                  |ИЗ
                  | Пользователи КАК Пользователи
                  |     ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.мСведенияОСотрудниках.СрезПоследних(&ДатаСреза, ) КАК мСведенияОСотрудникахСрезПоследних
                  |     ПО Пользователи.Пользователь = мСведенияОСотрудникахСрезПоследних.Пользователь
                  |     ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ГруппыПользователей.Состав КАК ГруппыПользователейСостав
                  |     ПО Пользователи.Пользователь = ГруппыПользователейСостав.Пользователь,
                  | Подразделения КАК Подразделения
                  |ГДЕ
                  | мСведенияОСотрудникахСрезПоследних.Пользователь = Пользователи.Пользователь";
				  
	Результат = Запрос.ВыполнитьПакет();
  
	ТаблицыДляДвижений = ДополнительныеСвойства.ТаблицыДляДвижений;
	ТаблицыДляДвижений.Вставить("ТаблицаСведенияОПользователях", Результат[0].Выгрузить());
	ТаблицыДляДвижений.Вставить("ТаблицаСведенияОСотрудниках", Результат[1].Выгрузить());
	ТаблицыДляДвижений.Вставить("ТаблицаСведенияОСотрудникахИзменения", Результат[4].Выгрузить());
		
КонецПроцедуры // ИнициализироватьДанныеДокумента()
